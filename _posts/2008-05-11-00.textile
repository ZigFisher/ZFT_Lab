---
layout:     post
title:      "Восстановление загрузчика CFE по JTAG на Sinus1054"
tagline:    ""
category:   ""
group:      best
tags:       [best, hwmod, broadcom]
---


h3. Описание

p. При восстановлении CFE загрузчика без Serial и конечно-же JTAG ничего не получится (смотрите соответствующие разделы сайта).

p. Для восстановления устройств на базе процессора BCM6345 воспользуйтесь программой tjtag3 и образцовым CFE загрузчиком sinus1054dsl-cfe-v01.bin. Данный файл является дампом загрузочной области флешки и не требует какой-либо конвертации. Файлы Tornado JTAG, CFE бутлоадер и драйвер LPT порта для Windows можно взять в соответствующих разделах файлового архива.

p. При работе с JTAG необходимо отпаять резистор 207 и перепаять его на посадочное место 208. Для нормальной работы роутера после программирования, резистор необходимо вернуть на старое место. На представленном фото (режим программирования) это не SMD, а обычный резистор (так удобнее).

p. Порядок работы с Tornado JTAG почти одинаков для Windows и Linux. Единственное отличие - для Windows необходимо установить драйвер LPT порта. Скачав sinus1054dsl-cfe-v01.bin с сайта переименуйте его в custom.bin и положите в один каталог к программе Tornado JTAG.

p. Роутеры Sinus 1054 DSL бывают двух типов, в одном из них стоит флеш фирмы Winbond (WB), в другом флеш (MX). При работе с флешками Winbond необходимо указывать дополнительный параметр /fc:48. При работе с флешками MX этот параметр необходимо исключить.

p. **Подключив JTAG и перепаяв резистор выполните проверку выполнив команду :**

pre. tjtag3 -probeonly /wiggler /fc:48 /noemw

p. **Для очистки Boot-раздела выполните команду :**

pre. tjtag3 -erase:cfe /noemw /wiggler /fc:48

p. **Для записи CFE загрузчика выполните команду :**

pre. tjtag3 -flash:custom /window:1fc00000 /start:1fc00000 /length:0xffff /noreset /bypass /wiggler /fc:48

p. **Для сохранения копии загрузчика находящегося в флешке выполнить команду :**

pre. tjtag3 -backup:cfe /wiggler /fc:37 /noemw

<hr>

h3. Фото

p. На фото возле пятачков нацарапаны цифры указывающие на соответствие выводов JTAG.

* 1 - TDO, паять на 5-й вывод Wiggler JTAG
* 2 - TDI, паять на 3-й вывод Wiggler JTAG
* 3 - TMS, паять на 7-й вывод Wiggler JTAG
* 5 - TCK, паять на 9-й вывод Wiggler JTAG

!/images/2008051101.jpg!

p. **Большую помощь в поиске JTAG на плате Sinus 1054 DSL оказал BlackDiamond, он-же Ilchuk Andrey Fedorovich, за что ему отдельное ОГРОМНОЕ спасибо !**
