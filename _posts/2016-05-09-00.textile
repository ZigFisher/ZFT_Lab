---
layout:     post
title:      "Sonoff шлюз - выпускаем розетки и выключатели в интернет"
tagline:    ""
category:   ""
group:      modules
tags:       [zftlab, esp8266, sonoff]
---


h3. Введение

p. Сегодня уже никого не удивишь наличием в доме сенсорных выключателей Livolo, а так-же недорогих управляемых проходных розеток с реле и радио-пультом, работающих в диапазоне 315/433 MHz.

p. Небольшая модернизация популярного IoT устройства "Sonoff":http://wiki.iteadstudio.com/Sonoff от компании "Itead":https://www.itead.cc/smart-home.html позволит не только управлять встроенным реле, а так-же управлять бытовыми приборами и освещением через Интернет.

p. Для управления устройствами лучше всего использовать прошивку "WiFi-IoT":http://wifi-iot.com, сервис управления и мониторинга "FlyHub":http://flyhub.org, а так-же программу для Android устройств *MQTT IoT*.

---

h3. Модернизация Sonoff

p. Для модернизации Sonoff понадобятся:

* передатчик на диапазон 315/433 MHz (должен быть совместим по диапазону)
* любой 1-wire или I2C датчик (опционально)
* пару кусочков монтажного провода, паяльник, инструмент и некоторые навыки работы

!/images/2016050901.jpg!

p. Передатчик прекрасно становится в отверстия, предназначенные для RF приёмника, который есть в более дорогих моделях. Поскольку там отсутствует стоящая рядом микросхема управления от приёмника, дорожки висят в воздухе.

!/images/2016050902.jpg!

p. Три перемычки подают на впаянный RF передатчик соответственно сигнал управления, питание 3,3V и землю (крайняя справа на пятак).

!/images/2016050903.jpg!

p. В некоторых случаях может понадобится уменьшить сопротивление резистора R5, стоящего левее и ниже светодиода (изначально установлен 1 kOm). Я просто напаял сверху такой-же и получил 510 Om общего сопротивления. Так-же необходимо откусить/отпаять вывод светодиода, вместо которого подключен передатчик ибо нагрузочная способность GPIO выводов ESP8266 невелика и передатчик НЕ работает одновременно со светодиодом.

!/images/2016050904.jpg!

p. Приятным бонусом является то, что выводы UART можно использовать для подключения 1-wire или I2C датчиков температуры, давления, влажности, освещённости и т.д. На фото видно подключение I2C датчика SHT21, где провода аккуратно можно вывести нажужу не меная контактам подключения нагрузки 220V.

!/images/2015032408.jpg!

p. Отдельно хочу сказать, что подобная конструкция с датчиком освещённости и датчиком движения будет прекрасным дополнением к уличному освещению - просто, дёшево, доступно. А главное - можно управлять и мониторить всё это через Интернет !

---

h3. Практическое использование

p. Пока некоторые из наработок я указал в ссылках. Как будет время допишу и, возможно, сниму кототкое видео.

---

h3. Внешние ссылки

* "-":-

---

h3. Внутренние ссылки

* "Подключение передатчика RCremote 315/433 MHz":http://zftlab.org/pages/2015032400.html
* "Отличные железки на SoC ESP8266 от Itead Studio":http://zftlab.org/pages/2016031000.html
